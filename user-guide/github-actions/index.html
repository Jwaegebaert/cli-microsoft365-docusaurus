<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-user-guide/github-actions">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions - CLI for Microsoft 365</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://clidemo.github.io/cli-microsoft365-docusaurus/user-guide/github-actions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions - CLI for Microsoft 365"><meta data-rh="true" name="description" content="GitHub Actions help you automate your software development workflows in the same place you store code and collaborate on pull requests and issues. You can write individual tasks, called actions, and combine them to create a custom workflow."><meta data-rh="true" property="og:description" content="GitHub Actions help you automate your software development workflows in the same place you store code and collaborate on pull requests and issues. You can write individual tasks, called actions, and combine them to create a custom workflow."><link data-rh="true" rel="icon" href="/cli-microsoft365-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clidemo.github.io/cli-microsoft365-docusaurus/user-guide/github-actions"><link data-rh="true" rel="alternate" href="https://clidemo.github.io/cli-microsoft365-docusaurus/user-guide/github-actions" hreflang="en"><link data-rh="true" rel="alternate" href="https://clidemo.github.io/cli-microsoft365-docusaurus/user-guide/github-actions" hreflang="x-default"><link rel="stylesheet" href="/cli-microsoft365-docusaurus/assets/css/styles.c2655f78.css">
<link rel="preload" href="/cli-microsoft365-docusaurus/assets/js/runtime~main.6b1321fc.js" as="script">
<link rel="preload" href="/cli-microsoft365-docusaurus/assets/js/main.ebf6c4f7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cli-microsoft365-docusaurus/"><div class="navbar__logo"><img src="/cli-microsoft365-docusaurus/img/pnp-cli-microsoft365-white.svg" alt="CLI for Microsoft 365 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/cli-microsoft365-docusaurus/img/pnp-cli-microsoft365-white.svg" alt="CLI for Microsoft 365 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/cli-microsoft365-docusaurus/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cli-microsoft365-docusaurus/user-guide">User Guide</a><a class="navbar__item navbar__link" href="/cli-microsoft365-docusaurus/cmd">Commands</a><a class="navbar__item navbar__link" href="/cli-microsoft365-docusaurus/concepts">Concepts</a><a class="navbar__item navbar__link" href="/cli-microsoft365-docusaurus/sample-scripts">Sample Scripts</a><a class="navbar__item navbar__link" href="/cli-microsoft365-docusaurus/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/cli-microsoft365-docusaurus/user-guide">User Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/installing-cli">Install the CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/using-cli">Use the CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/run-cli-in-docker-container">Run CLI in a Docker Container</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/connecting-office-365">Log in to Microsoft 365</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/cli-output-mode">CLI output mode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/filter-cli-data">Filter CLI data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/configuring-cli">Configure CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/completion">Command completion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/using-own-identity">Use your own Azure AD identity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/cli-certificate-caveats">Caveats when working with the CLI and certificate login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/github-actions">Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/manage-microsoft-365-apps">Manage Microsoft 365 apps with the CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cli-microsoft365-docusaurus/user-guide/use-cli-api">Use CLI programmatically</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cli-microsoft365-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cli-microsoft365-docusaurus/user-guide"><span itemprop="name">User Guide</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions</h1><p><a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer">GitHub Actions</a> help you automate your software development workflows in the same place you store code and collaborate on pull requests and issues. You can write individual tasks, called actions, and combine them to create a custom workflow.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actions">Actions<a class="hash-link" href="#actions" title="Direct link to heading">​</a></h2><p>We have built and published actions to the <a href="https://github.com/marketplace?type=actions" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a> that will enable you to easily install and execute CLI for Microsoft 365 commands from within your own custom workflows.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-for-microsoft-365-login">CLI for Microsoft 365 Login<a class="hash-link" href="#cli-for-microsoft-365-login" title="Direct link to heading">​</a></h3><p>This action performs two roles, firstly it installs the CLI for Microsoft 365 into your build host agent and secondly, it creates a connection to your Microsoft 365 tenant which can then be used by other actions.</p><p>!!! important
This action is required to be executed in a step before any other CLI for Microsoft 365 actions</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-for-microsoft-365-deploy-app">CLI for Microsoft 365 Deploy App<a class="hash-link" href="#cli-for-microsoft-365-deploy-app" title="Direct link to heading">​</a></h3><p>This action simplifies the installation and deployment of a SharePoint Framework app to either a tenant level or site collection level app catalog.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-365-run-script">Microsoft 365 Run Script<a class="hash-link" href="#microsoft-365-run-script" title="Direct link to heading">​</a></h3><p>This action provides the ability to execute an inline script or script file using either <code>bash</code> or <code>PowerShell</code> as the executing shell.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial">Tutorial<a class="hash-link" href="#tutorial" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-basic-workflow-which-authenticates-with-an-microsoft-365-tenant">Creating a basic workflow which authenticates with an Microsoft 365 tenant<a class="hash-link" href="#creating-a-basic-workflow-which-authenticates-with-an-microsoft-365-tenant" title="Direct link to heading">​</a></h3><p>We are going to assume that you have a GitHub repository already created, which you are also the owner of.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-secrets">Create secrets<a class="hash-link" href="#create-secrets" title="Direct link to heading">​</a></h4><p>When connecting to any system or service, we need to make sure that the account details used to connect are kept in a safe and secure way. GitHub provides a way of storing these credentials in encrypted form in your repository, which can then be reused in your custom workflows.</p><p>First you will need to need to navigate, in your browser, to your repository on GitHub.com and go to the <code>Settings</code> tab, from here choose the <code>Secrets</code> item on the left hand menu.</p><p>Using the <code>Add new secret</code> link, enter the <code>ADMIN_USERNAME</code> into the <code>Name</code> field and the username of the account that you are to use to connect to your Microsoft 365 tenant with, e.g. <code>user@tenant.onmicrosoft.com</code>. <em>Note: This account should not be protected with multi factor authentication</em></p><p>Repeat the above step to also store the account password which should be named <code>ADMIN_PASSWORD</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="setup-workflow">Setup workflow<a class="hash-link" href="#setup-workflow" title="Direct link to heading">​</a></h4><p>Now that we have secured the account credentials, we can start to create the workflow.</p><p>Select <code>Actions</code> tab and you will be presented with the <code>Get started with GitHub Actions</code> page. This will display a selection of templates to start your workflow from, however, for the purpose of this tutorial we will create a new workflow from scratch.</p><p>To do that, click the <code>Setup a workflow yourself</code> button which is placed on the far right of the page.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-build-definition-file">Update the build definition file<a class="hash-link" href="#update-the-build-definition-file" title="Direct link to heading">​</a></h4><p>You will be presented with a screen displaying a file editor which has the below <code>yaml</code>. The <code>YAML</code> file represents a custom workflow and is sometimes referred to as <code>Build Definition as Code</code>.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> CI</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> actions/checkout@v1</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Run a one</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">line script</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> echo Hello</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> world</span><span class="token tag" style="color:rgb(153, 76, 195)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Run a multi</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">line script</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">|</span><span class="token scalar string" style="color:rgb(72, 118, 214)"></span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        echo Add other actions to build,</span><br></span><span class="token-line" style="color:#403f53"><span class="token scalar string" style="color:rgb(72, 118, 214)">        echo test, and deploy your project.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above configuration defines a simple workflow named <code>CI</code> that is triggered on the <code>push</code> of new code to the repository, it contains a single <code>build</code> that is executed on an <code>ubuntu</code> hosted agent and has multiple steps that, execute a single line script and multi line script, both printing text to the logs.</p><p>We will update the initial configuration as shown below, replacing the existing steps with the <code>CLI for Microsoft 365 Login</code> action instead.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> CI</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Login to tenant</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">login@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">ADMIN_USERNAME</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  $</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> secrets.ADMIN_USERNAME </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">ADMIN_PASSWORD</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  $</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> secrets.ADMIN_PASSWORD </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>uses</code> property tells the build agent to use the <code>CLI for Microsoft 365</code> GitHub Action for the step, this will automatically become available when the workflow is triggered, no installation is required.</p><p>The action accepts an admin username and password, which are used to authenticate with your Microsoft 365 tenant, these credentials are provided by an environment variable called <code>secrets</code> which contains properties exposing the secured credentials that we saved earlier.</p><p>Lastly, we need to commit the <code>main.yaml</code> file to the repository, click the <code>Start Commit</code> button and click <code>Commit new file</code>. You may want enter a custom commit message at this point, however the default will be fine for this tutorial.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="confirm-the-build-has-completed-successfully">Confirm the build has completed successfully<a class="hash-link" href="#confirm-the-build-has-completed-successfully" title="Direct link to heading">​</a></h4><p>As we setup the workflow to be triggered on the <code>push</code> of new code to the repository, the <code>CI</code> workflow is automatically run when we initially created the workflow in the repository.</p><p>Select the <code>Actions</code> tab, this time you will be presented with a table that displays the <code>CI</code> run either in progress or completed, click on the run called <code>CI</code> in the table to view the workflow output logs.</p><p>You will see that all steps have a green tick, expanding the <code>Login tenant</code> step will display further detail generated from the <code>CLI for Microsoft 365 Login</code> action, with the last log confirming that the login was successful.  </p><p>Congratulations! You have just setup your first custom workflow in a GitHub repository and successfully logged into Microsoft 365 using the <code>Microsoft 365 Login</code> action.</p><p><img loading="lazy" alt="CI Successful build" src="/cli-microsoft365-docusaurus/assets/images/github-actions-tutorial-success-2d9f625dba2c93b8c7d8e5513de1908d.png" title="CI Successful Build" width="2560" height="1440" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-guides">How-To Guides<a class="hash-link" href="#how-to-guides" title="Direct link to heading">​</a></h2><p>These guides presuppose some familiarity with using GitHub Actions and CLI for Microsoft 365.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-an-app-using-the-cli-for-microsoft-365-deploy-app-action">Deploy an app using the CLI for Microsoft 365 Deploy App action<a class="hash-link" href="#deploy-an-app-using-the-cli-for-microsoft-365-deploy-app-action" title="Direct link to heading">​</a></h3><p>Create a <code>.yaml</code> file within the <code>.github/workflow</code> folder with the below build definition to deploy an app to a tenant level app catalog.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> SPFx CI/CD with CLI for Microsoft 365</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">##</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## Build code omitted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">##</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">deploy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">needs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">strategy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">matrix</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">node-version</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">10.x</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">##</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">## Code to get the package omitted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">##</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Login to tenant</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">login@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">ADMIN_USERNAME</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  $</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> secrets.ADMIN_USERNAME </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">ADMIN_PASSWORD</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  $</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> secrets.ADMIN_PASSWORD </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Deploy app to tenant app catalog</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> o365clideploy</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">deploy@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">APP_FILE_PATH</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sharepoint/solution/spfx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">m365</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">action.sppkg</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">SKIP_FEATURE_DEPLOYMENT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">OVERWRITE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Get the id of the app deployed</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> echo &quot;The id of the app deployed is $</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> steps.o365clideploy.outputs.APP_ID </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively, you can deploy the app to a site collection based app catalog by using the below step in replacement of the <code>Deploy app to tenant app catalog</code> step.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Deploy app to a site collection app catalog</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> o365clideploy</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">deploy@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">APP_FILE_PATH</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sharepoint/solution/spfx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">m365</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">action.sppkg</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">SCOPE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sitecollection</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token key atrule">SITE_COLLECTION_URL</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">//contoso.sharepoint.com/sites/teamsite</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="execute-an-inline-script-using-the-cli-for-microsoft-365-run-script-action">Execute an inline script using the CLI for Microsoft 365 Run Script action<a class="hash-link" href="#execute-an-inline-script-using-the-cli-for-microsoft-365-run-script-action" title="Direct link to heading">​</a></h3><p>Add this step to a <code>.yaml</code> build file contained within the <code>.github/workflows</code> folder to send an email from SharePoint to a user by executing the <code>spo mail send</code> command as an inline script.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Send email</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">runscript@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">O365_CLI_SCRIPT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> m365 spo mail send </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">webUrl https</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">//contoso.sharepoint.com/sites/teamsite </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">to &#x27;user@contoso.onmicrosoft.com&#x27; </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">subject &#x27;Deployment done&#x27; </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">body &#x27;&lt;h2</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">CLI for Microsoft 365&lt;/h2</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"> &lt;p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">The deployment is complete.&lt;/p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"> &lt;br/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain"> Email sent via CLI for Microsoft 365 GitHub Action.&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="execute-a-script-file-using-the-cli-for-microsoft-365-run-script-action">Execute a script file using the CLI for Microsoft 365 Run Script action<a class="hash-link" href="#execute-a-script-file-using-the-cli-for-microsoft-365-run-script-action" title="Direct link to heading">​</a></h3><p>Add the respective script file to your repository and this step to a <code>.yaml</code> build file contained within the <code>.github/workflows</code> folder to create lists by executing the commands contained within the script file.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> Create lists</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> pnp/action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">cli</span><span class="token punctuation" style="color:rgb(153, 76, 195)">-</span><span class="token plain">runscript@v1.0.0</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token key atrule">O365_CLI_SCRIPT_PATH</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> ./script/lists.ps1 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reference">Reference<a class="hash-link" href="#reference" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-for-microsoft-365-login-1">CLI for Microsoft 365 Login<a class="hash-link" href="#cli-for-microsoft-365-login-1" title="Direct link to heading">​</a></h3><p>View on <a href="https://github.com/marketplace/actions/cli-for-microsoft-365-login" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="inputs">Inputs<a class="hash-link" href="#inputs" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Description</th><th></th></tr></thead><tbody><tr><td><code>ADMIN_USERNAME</code></td><td>The username of the account used to login</td><td>Required</td></tr><tr><td><code>ADMIN_PASSWORD</code></td><td>The password of the account used to login</td><td>Required</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-365-deploy-app">Microsoft 365 Deploy App<a class="hash-link" href="#microsoft-365-deploy-app" title="Direct link to heading">​</a></h3><p>View on <a href="https://github.com/marketplace/actions/cli-for-microsoft-365-deploy-app" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="inputs-1">Inputs<a class="hash-link" href="#inputs-1" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Description</th><th></th></tr></thead><tbody><tr><td><code>APP_FILE_PATH</code></td><td>Relative path of the app in your repo</td><td>Required</td></tr><tr><td><code>SCOPE</code></td><td>Scope of the app catalog: <code>tenant,sitecollection</code>. Default is <code>tenant</code></td><td>Optional</td></tr><tr><td><code>SITE_COLLECTION_URL</code></td><td>The URL of the site collection where the solution package will be added</td><td>Required if scope is set to <code>sitecollection</code></td></tr><tr><td><code>SKIP_FEATURE_DEPLOYMENT</code></td><td><code>true,false</code> If the app supports tenant-wide deployment, deploy it to the whole tenant. Default is <code>false</code></td><td>Optional</td></tr><tr><td><code>OVERWRITE</code></td><td><code>true,false</code> Set to overwrite the existing package file. Default is <code>false</code></td><td>Optional</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="output">Output<a class="hash-link" href="#output" title="Direct link to heading">​</a></h4><p>The <code>APP_ID</code> of the app that has been deployed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-365-run-script-1">Microsoft 365 Run Script<a class="hash-link" href="#microsoft-365-run-script-1" title="Direct link to heading">​</a></h3><p>View on <a href="https://github.com/marketplace/actions/cli-for-microsoft-365-run-script" target="_blank" rel="noopener noreferrer">GitHub Marketplace</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="inputs-2">Inputs<a class="hash-link" href="#inputs-2" title="Direct link to heading">​</a></h4><table><thead><tr><th>Name</th><th>Description</th><th></th></tr></thead><tbody><tr><td><code>O365_CLI_SCRIPT_PATH</code></td><td>Relative path to the script</td><td>Required</td></tr><tr><td><code>O365_CLI_SCRIPT</code></td><td>The script to run</td><td>Required</td></tr><tr><td><code>IS_POWERSHELL</code></td><td>Used only with <code>O365_CLI_SCRIPT</code>. If <code>true</code>, <code>O365_CLI_SCRIPT</code> will be passed as a PowerShell script, otherwise the assumption is <code>bash</code> script. Default is <code>false</code></td><td>Optional</td></tr></tbody></table><p>!!! attention
One of <code>O365_CLI_SCRIPT_PATH</code> / <code>O365_CLI_SCRIPT</code> is mandatory, in case both are defined <code>O365_CLI_SCRIPT_PATH</code> gets preference.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contributions-and-issues">Contributions and Issues<a class="hash-link" href="#contributions-and-issues" title="Direct link to heading">​</a></h2><p>Due to the requirement that a GitHub action must be located within its own repository, these actions are not managed within the main CLI for Microsoft 365 repository.</p><p>If you have any ideas or issues regarding any of the actions, please raise them within the issue list of their respective repositories.</p><ul><li><a href="https://github.com/pnp/action-cli-login/issues" target="_blank" rel="noopener noreferrer">CLI for Microsoft 365 Login Issues</a></li><li><a href="https://github.com/pnp/action-cli-deploy/issues" target="_blank" rel="noopener noreferrer">CLI for Microsoft 365 Deploy Issues</a></li><li><a href="https://github.com/pnp/action-cli-runscript/issues" target="_blank" rel="noopener noreferrer">CLI for Microsoft 365 Run Script Issues</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/user-guide/github-actions.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-01-04T10:44:38.000Z">Jan 4, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/cli-microsoft365-docusaurus/user-guide/cli-certificate-caveats"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Caveats when working with the CLI and certificate login</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cli-microsoft365-docusaurus/user-guide/manage-microsoft-365-apps"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Manage Microsoft 365 apps with the CLI</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#actions" class="table-of-contents__link toc-highlight">Actions</a><ul><li><a href="#cli-for-microsoft-365-login" class="table-of-contents__link toc-highlight">CLI for Microsoft 365 Login</a></li><li><a href="#cli-for-microsoft-365-deploy-app" class="table-of-contents__link toc-highlight">CLI for Microsoft 365 Deploy App</a></li><li><a href="#microsoft-365-run-script" class="table-of-contents__link toc-highlight">Microsoft 365 Run Script</a></li></ul></li><li><a href="#tutorial" class="table-of-contents__link toc-highlight">Tutorial</a><ul><li><a href="#creating-a-basic-workflow-which-authenticates-with-an-microsoft-365-tenant" class="table-of-contents__link toc-highlight">Creating a basic workflow which authenticates with an Microsoft 365 tenant</a></li></ul></li><li><a href="#how-to-guides" class="table-of-contents__link toc-highlight">How-To Guides</a><ul><li><a href="#deploy-an-app-using-the-cli-for-microsoft-365-deploy-app-action" class="table-of-contents__link toc-highlight">Deploy an app using the CLI for Microsoft 365 Deploy App action</a></li><li><a href="#execute-an-inline-script-using-the-cli-for-microsoft-365-run-script-action" class="table-of-contents__link toc-highlight">Execute an inline script using the CLI for Microsoft 365 Run Script action</a></li><li><a href="#execute-a-script-file-using-the-cli-for-microsoft-365-run-script-action" class="table-of-contents__link toc-highlight">Execute a script file using the CLI for Microsoft 365 Run Script action</a></li></ul></li><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a><ul><li><a href="#cli-for-microsoft-365-login-1" class="table-of-contents__link toc-highlight">CLI for Microsoft 365 Login</a></li><li><a href="#microsoft-365-deploy-app" class="table-of-contents__link toc-highlight">Microsoft 365 Deploy App</a></li><li><a href="#microsoft-365-run-script-1" class="table-of-contents__link toc-highlight">Microsoft 365 Run Script</a></li></ul></li><li><a href="#contributions-and-issues" class="table-of-contents__link toc-highlight">Contributions and Issues</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/7rfW4kg6B5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/climicrosoft365" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/pnp/cli-microsoft365" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://aka.ms/sppnp-videos" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aka.ms/sppnp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Microsoft 365 &amp; Power Platform community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 CLI for Microsoft 365. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cli-microsoft365-docusaurus/assets/js/runtime~main.6b1321fc.js"></script>
<script src="/cli-microsoft365-docusaurus/assets/js/main.ebf6c4f7.js"></script>
</body>
</html>