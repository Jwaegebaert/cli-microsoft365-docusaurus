<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-v5-upgrade-guidance">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">v5 Upgrade Guidance - CLI for Microsoft 365</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://clidemo.github.io/v5-upgrade-guidance"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="v5 Upgrade Guidance - CLI for Microsoft 365"><meta data-rh="true" name="description" content="The v5 of CLI for Microsoft 365 introduces several breaking changes. To help you upgrade to the latest version of CLI for Microsoft 365, we&#x27;ve listed those changes along with any actions you may need to take."><meta data-rh="true" property="og:description" content="The v5 of CLI for Microsoft 365 introduces several breaking changes. To help you upgrade to the latest version of CLI for Microsoft 365, we&#x27;ve listed those changes along with any actions you may need to take."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clidemo.github.io/v5-upgrade-guidance"><link data-rh="true" rel="alternate" href="https://clidemo.github.io/v5-upgrade-guidance" hreflang="en"><link data-rh="true" rel="alternate" href="https://clidemo.github.io/v5-upgrade-guidance" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8c7000b4.css">
<link rel="preload" href="/assets/js/runtime~main.d486b7c8.js" as="script">
<link rel="preload" href="/assets/js/main.1875d23a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/pnp-cli-microsoft365-white.svg" alt="CLI for Microsoft 365 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/pnp-cli-microsoft365-white.svg" alt="CLI for Microsoft 365 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/user-guide/installing-cli">User Guide</a><a class="navbar__item navbar__link" href="/cmd/login">Commands</a><a class="navbar__item navbar__link" href="/concepts/persisting-connection">Concepts</a><a class="navbar__item navbar__link" href="/sample-scripts/">Sample Scripts</a><a class="navbar__item navbar__link" href="/about/why-cli">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">CLI for Microsoft 365</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v6-upgrade-guidance">v6 Upgrade Guidance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/v5-upgrade-guidance">v5 Upgrade Guidance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v4-upgrade-guidance">v4 Upgrade Guidance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v3-upgrade-guidance">v3 Upgrade Guidance</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">v5 Upgrade Guidance</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>v5 Upgrade Guidance</h1><p>The v5 of CLI for Microsoft 365 introduces several breaking changes. To help you upgrade to the latest version of CLI for Microsoft 365, we&#x27;ve listed those changes along with any actions you may need to take.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-ad-related-commands-migrated-to-microsoft-graph">Azure-AD related commands migrated to Microsoft Graph<a class="hash-link" href="#azure-ad-related-commands-migrated-to-microsoft-graph" title="Direct link to heading">​</a></h2><p>In CLI for Microsoft 365 we have commands that allow you to manage Azure AD apps. Some of these commands were using the Azure AD Graph API, which has been <a href="https://docs.microsoft.com/graph/migrate-azure-ad-graph-faq#how-is-microsoft-graph-different-from-azure-ad-graph-and-why-should-i-migrate-my-apps" target="_blank" rel="noopener noreferrer">deprecated</a> since June 30, 2020 and which will be retired on June 30, 2022. To guarantee that the CLI for Microsoft 365 will keep working, we migrated the affected commands to use the Microsoft Graph. Here&#x27;s the list of the affected commands:</p><ul><li><a href="/cmd/aad/oauth2grant/oauth2grant-list">aad oauth2grant list</a></li><li><a href="/cmd/aad/sp/sp-get">aad sp get</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-action-do-i-need-to-take">What action do I need to take?<a class="hash-link" href="#what-action-do-i-need-to-take" title="Direct link to heading">​</a></h3><p>While the options of the commands haven&#x27;t changed, the data returned by the command might be different. If you use either command in a script, please verify that the script is working as intended. Here are the differences in the data returned by the <a href="https://docs.microsoft.com/graph/migrate-azure-ad-graph-property-differences#oauth2permissionsgrant-property-differences" target="_blank" rel="noopener noreferrer">aad oauth2grant list</a> and <a href="https://docs.microsoft.com/graph/migrate-azure-ad-graph-property-differences#serviceprincipal-property-differences" target="_blank" rel="noopener noreferrer">aad sp get</a> commands.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="in-aad-oauth2grant-list-renamed-clientid-to-spobjectid">In <code>aad oauth2grant list</code> renamed <code>clientId</code> to <code>spObjectId</code><a class="hash-link" href="#in-aad-oauth2grant-list-renamed-clientid-to-spobjectid" title="Direct link to heading">​</a></h2><p>In the <a href="/cmd/aad/oauth2grant/oauth2grant-list">aad oauth2grant list</a> command, we used to have the <code>clientId</code> option to specify the <code>objectId</code> of the service principal. The name was confusing and not self-explanatory, which is why we decided to rename it to <code>spObjectId</code>. The value of the option is the same. It&#x27;s just the name of the property that changed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-action-do-i-need-to-take-1">What action do I need to take?<a class="hash-link" href="#what-action-do-i-need-to-take-1" title="Direct link to heading">​</a></h3><p>If you use the <code>aad oauth2grant list</code> command, replace the <code>clientId</code> option with <code>spObjectId</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extended-aad-oauth2grant-remove-with-confirm">Extended <code>aad oauth2grant remove</code> with <code>confirm</code><a class="hash-link" href="#extended-aad-oauth2grant-remove-with-confirm" title="Direct link to heading">​</a></h2><p>In CLI for Microsoft 365, removing an object is non-reversible. To prevent accidental removal, all remove commands include a prompt which can be suppressed using the <code>confirm</code> option. The <code>aad oauth2grant remove</code> command didn&#x27;t show the prompt and used to delete the grant directly. To align the command with other commands in the CLI, we extended it with the <code>confirm</code> option and showing a confirmation prompt when the <code>confirm</code> option hasn&#x27;t been specified.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-action-do-i-need-to-take-2">What action do I need to take?<a class="hash-link" href="#what-action-do-i-need-to-take-2" title="Direct link to heading">​</a></h3><p>If you use the <code>aad oauth2grant remove</code> command in your scripts, extend it with the <code>--confirm</code> option to suppress the prompt and ensure that the script will run without requiring user interaction.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/v5-upgrade-guidance.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-01-05T14:48:20.000Z">Jan 5, 2023</time></b> by <b>Jwaegebaert</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v6-upgrade-guidance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">v6 Upgrade Guidance</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v4-upgrade-guidance"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">v4 Upgrade Guidance</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#azure-ad-related-commands-migrated-to-microsoft-graph" class="table-of-contents__link toc-highlight">Azure-AD related commands migrated to Microsoft Graph</a><ul><li><a href="#what-action-do-i-need-to-take" class="table-of-contents__link toc-highlight">What action do I need to take?</a></li></ul></li><li><a href="#in-aad-oauth2grant-list-renamed-clientid-to-spobjectid" class="table-of-contents__link toc-highlight">In <code>aad oauth2grant list</code> renamed <code>clientId</code> to <code>spObjectId</code></a><ul><li><a href="#what-action-do-i-need-to-take-1" class="table-of-contents__link toc-highlight">What action do I need to take?</a></li></ul></li><li><a href="#extended-aad-oauth2grant-remove-with-confirm" class="table-of-contents__link toc-highlight">Extended <code>aad oauth2grant remove</code> with <code>confirm</code></a><ul><li><a href="#what-action-do-i-need-to-take-2" class="table-of-contents__link toc-highlight">What action do I need to take?</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/7rfW4kg6B5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/climicrosoft365" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/pnp/cli-microsoft365" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://aka.ms/sppnp-videos" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aka.ms/sppnp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Microsoft 365 &amp; Power Platform community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 CLI for Microsoft 365. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d486b7c8.js"></script>
<script src="/assets/js/main.1875d23a.js"></script>
</body>
</html>