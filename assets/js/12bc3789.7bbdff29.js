"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[65286],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>k});var o=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=o.createContext({}),s=function(e){var t=o.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},m=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},d="mdxType",l={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,c=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=s(a),u=n,k=d["".concat(c,".").concat(u)]||d[u]||l[u]||r;return a?o.createElement(k,p(p({ref:t},m),{},{components:a})):o.createElement(k,p({ref:t},m))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,p=new Array(r);p[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[d]="string"==typeof e?e:n,p[1]=i;for(var s=2;s<r;s++)p[s]=a[s];return o.createElement.apply(null,p)}return o.createElement.apply(null,a)}u.displayName="MDXCreateElement"},26054:(e,t,a)=>{a.d(t,{ZP:()=>i});var o=a(87462),n=(a(67294),a(3905));const r={toc:[]},p="wrapper";function i(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,o.Z)({},r,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("dl",null,(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-h, --help [help]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Output usage information. Optionally, specify which section of command's help you want to see. Allowed values are ",(0,n.kt)("code",{parentName:"p"},"options"),", ",(0,n.kt)("code",{parentName:"p"},"examples"),", ",(0,n.kt)("code",{parentName:"p"},"remarks"),", ",(0,n.kt)("code",{parentName:"p"},"response"),", ",(0,n.kt)("code",{parentName:"p"},"full"),". Default is ",(0,n.kt)("code",{parentName:"p"},"full"),".")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--query [query]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"JMESPath query string. See ",(0,n.kt)("a",{parentName:"p",href:"http://jmespath.org/"},"http://jmespath.org/")," for more information and examples")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-o, --output [output]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Output type. ",(0,n.kt)("code",{parentName:"p"},"json,text,csv,md"),". Default ",(0,n.kt)("code",{parentName:"p"},"json"))),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--verbose"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Runs command with verbose logging")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--debug"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Runs command with debug logging"))))}i.isMDXComponent=!0},66626:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>p,metadata:()=>c,toc:()=>m});var o=a(87462),n=(a(67294),a(3905)),r=a(26054);const p={},i="viva connections app create",c={unversionedId:"cmd/viva/connections/connections-app-create",id:"cmd/viva/connections/connections-app-create",title:"viva connections app create",description:"Creates a Viva Connections desktop app package to upload to Microsoft Teams",source:"@site/docs/cmd/viva/connections/connections-app-create.mdx",sourceDirName:"cmd/viva/connections",slug:"/cmd/viva/connections/connections-app-create",permalink:"/cli-microsoft365-docusaurus/cmd/viva/connections/connections-app-create",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/cmd/viva/connections/connections-app-create.mdx",tags:[],version:"current",lastUpdatedAt:1683150705,formattedLastUpdatedAt:"May 3, 2023",frontMatter:{},sidebar:"commands",previous:{title:"todo task set",permalink:"/cli-microsoft365-docusaurus/cmd/todo/task/task-set"},next:{title:"yammer search",permalink:"/cli-microsoft365-docusaurus/cmd/yammer/yammer-search"}},s={},m=[{value:"Usage",id:"usage",level:2},{value:"Options",id:"options",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Examples",id:"examples",level:2},{value:"Response",id:"response",level:2},{value:"More information",id:"more-information",level:2}],d={toc:m},l="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(l,(0,o.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"viva-connections-app-create"},"viva connections app create"),(0,n.kt)("p",null,"Creates a Viva Connections desktop app package to upload to Microsoft Teams"),(0,n.kt)("h2",{id:"usage"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 viva connections app create [options]\n")),(0,n.kt)("h2",{id:"options"},"Options"),(0,n.kt)("dl",null,(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--portalUrl <portalUrl>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The URL of the site to pin in Microsoft Teams. Must be a Communication site")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--name <name>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Name of the app to create, eg. ",(0,n.kt)("code",{parentName:"p"},"Contoso"),". No longer than 30 characters")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--description <description>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Short description of the app. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog. No longer than 80 characters")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--longDescription <longDescription>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Long description of the app. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog. No longer than 4000 characters")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--privacyPolicyUrl [privacyPolicyUrl]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"URL to your organization's privacy policy. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog. Defaults to ",(0,n.kt)("code",{parentName:"p"},"https://privacy.microsoft.com/en-us/privacystatement")," if not specified")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--termsOfUseUrl [termsOfUseUrl]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"URL to your organization's terms of use. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog. Defaults to ",(0,n.kt)("code",{parentName:"p"},"https://go.microsoft.com/fwlink/?linkid=2039674")," if not specified")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--companyName <companyName>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Your organization's name. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--companyWebsiteUrl <companyWebsiteUrl>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Your organization's website URL. Displayed in the app's ",(0,n.kt)("em",{parentName:"p"},"About")," dialog")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--coloredIconPath <coloredIconPath>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Absolute or relative path to the color icon for your app")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--outlineIconPath <outlineIconPath>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Absolute or relative path to the outline icon for your app")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--accentColor [accentColor]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"A HEX color to use in conjunction with and as a background for your outline icon. Defaults to ",(0,n.kt)("code",{parentName:"p"},"#40497E")," if not specified")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--force"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Specify, to overwrite the existing package file on disk"))),(0,n.kt)(r.ZP,{mdxType:"Global"}),(0,n.kt)("h2",{id:"remarks"},"Remarks"),(0,n.kt)("p",null,"If the specified portal URL doesn't exist, the command will a ",(0,n.kt)("inlineCode",{parentName:"p"},"404 - FILE NOT FOUND")," error."),(0,n.kt)("p",null,"The specified portal URL must point to a valid Communication site. To get the list of Communication sites in your tenant, execute: ",(0,n.kt)("inlineCode",{parentName:"p"},"m365 spo site list --type CommunicationSite"),"."),(0,n.kt)("p",null,"The command generates a Microsoft Teams app package. App packages must meet specific requirements to be uploaded to Microsoft Teams. Specified attributes must not exceed their maximum length and the specified color and outline icons must be respectively 192x192px and 32x32px. For the latest list of requirements, see the links in the ",(0,n.kt)("strong",{parentName:"p"},"More information")," section at the end of this page. The generated app package will be written in the current working folder."),(0,n.kt)("p",null,"After creating the Viva Connections desktop app package, you need to upload it to your Microsoft Teams app catalog. You can do it either manually, or using the CLI by executing ",(0,n.kt)("inlineCode",{parentName:"p"},"m365 teams app publish --filePath ./contoso.zip"),"."),(0,n.kt)("h2",{id:"examples"},"Examples"),(0,n.kt)("p",null,"Create a Viva Connections desktop app package"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 viva connections app create --portalUrl https://contoso.sharepoint.com --name Contoso --description "Contoso company app" --longDescription "Stay on top of what\'s happening at Contoso" --companyName Contoso --companyWebsiteUrl https://contoso.com --coloredIconPath icon-color.png --outlineIconPath icon-outline.png\n')),(0,n.kt)("h2",{id:"response"},"Response"),(0,n.kt)("p",null,"The command won't return a response on success."),(0,n.kt)("h2",{id:"more-information"},"More information"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Add Viva Connections for Microsoft Teams desktop: ",(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/sharepoint/viva-connections?WT.mc_id=m365-15896-cxa"},"https://docs.microsoft.com/sharepoint/viva-connections")),(0,n.kt)("li",{parentName:"ul"},"App manifest checklist: ",(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/microsoftteams/platform/concepts/deploy-and-publish/appsource/prepare/app-manifest-checklist?WT.mc_id=m365-15896-cxa"},"https://docs.microsoft.com/microsoftteams/platform/concepts/deploy-and-publish/appsource/prepare/app-manifest-checklist")),(0,n.kt)("li",{parentName:"ul"},"Reference: Manifest schema for Microsoft Teams: ",(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema?WT.mc_id=m365-15896-cxa"},"https://docs.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema"))))}u.isMDXComponent=!0}}]);