"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[85241],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>d});var r=o(67294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function n(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function p(e,t){if(null==e)return{};var o,r,a=function(e,t){if(null==e)return{};var o,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)o=i[r],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)o=i[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=r.createContext({}),c=function(e){var t=r.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):n(n({},t),e)),o},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},l="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var o=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),l=c(o),f=a,d=l["".concat(s,".").concat(f)]||l[f]||m[f]||i;return o?r.createElement(d,n(n({ref:t},u),{},{components:o})):r.createElement(d,n({ref:t},u))}));function d(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=o.length,n=new Array(i);n[0]=f;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p[l]="string"==typeof e?e:a,n[1]=p;for(var c=2;c<i;c++)n[c]=o[c];return r.createElement.apply(null,n)}return r.createElement.apply(null,o)}f.displayName="MDXCreateElement"},40111:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>n,default:()=>m,frontMatter:()=>i,metadata:()=>p,toc:()=>c});var r=o(87462),a=(o(67294),o(3905));const i={title:"Manage Microsoft 365 apps with the CLI",sidebar_position:12},n="Manage Microsoft 365 apps with the CLI for Microsoft 365",p={unversionedId:"user-guide/manage-microsoft-365-apps",id:"user-guide/manage-microsoft-365-apps",title:"Manage Microsoft 365 apps with the CLI",description:"When developing Microsoft 365 apps, you need to register them with the Microsoft cloud. You do this by creating an Azure AD app registration. An Azure AD app registration contains information about your app such as its name, type (for example if it's a client app or a web app) or API permissions. Typically, you manage these settings through the Azure portal. CLI for Microsoft 365 contains a set of commands that simplify managing Azure AD app registrations for your Microsoft 365 apps. What's more, using CLI for Microsoft 365 you can automate create Azure AD apps to allow developers in your team share their configuration without blocking each other.",source:"@site/docs/user-guide/manage-microsoft-365-apps.mdx",sourceDirName:"user-guide",slug:"/user-guide/manage-microsoft-365-apps",permalink:"/cli-microsoft365-docusaurus/user-guide/manage-microsoft-365-apps",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/user-guide/manage-microsoft-365-apps.mdx",tags:[],version:"current",lastUpdatedAt:1685025201,formattedLastUpdatedAt:"May 25, 2023",sidebarPosition:12,frontMatter:{title:"Manage Microsoft 365 apps with the CLI",sidebar_position:12},sidebar:"userGuide",previous:{title:"Automate your CI/CD workflow using CLI for Microsoft 365 GitHub Actions",permalink:"/cli-microsoft365-docusaurus/user-guide/github-actions"},next:{title:"Use CLI programmatically",permalink:"/cli-microsoft365-docusaurus/user-guide/use-cli-api"}},s={},c=[{value:"Step 1: Create Azure AD app registration",id:"step-1-create-azure-ad-app-registration",level:2},{value:"Step 2: Store information about your Azure AD app in your project",id:"step-2-store-information-about-your-azure-ad-app-in-your-project",level:2},{value:"Step 3: Manage Azure AD app registrations for Microsoft 365 apps",id:"step-3-manage-azure-ad-app-registrations-for-microsoft-365-apps",level:2}],u={toc:c},l="wrapper";function m(e){let{components:t,...o}=e;return(0,a.kt)(l,(0,r.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"manage-microsoft-365-apps-with-the-cli-for-microsoft-365"},"Manage Microsoft 365 apps with the CLI for Microsoft 365"),(0,a.kt)("p",null,"When developing Microsoft 365 apps, you need to register them with the Microsoft cloud. You do this by creating an Azure AD app registration. An Azure AD app registration contains information about your app such as its name, type (for example if it's a client app or a web app) or API permissions. Typically, you manage these settings through the Azure portal. CLI for Microsoft 365 contains a set of commands that simplify managing Azure AD app registrations for your Microsoft 365 apps. What's more, using CLI for Microsoft 365 you can automate create Azure AD apps to allow developers in your team share their configuration without blocking each other."),(0,a.kt)("h2",{id:"step-1-create-azure-ad-app-registration"},"Step 1: Create Azure AD app registration"),(0,a.kt)("p",null,"You start bringing your app to Microsoft 365 by creating an application registration in Azure Active Directory. Using CLI for Microsoft 365, you can do this using the ",(0,a.kt)("inlineCode",{parentName:"p"},"m365 aad app add")," command. For example, if you're building a single-page application, you'd execute:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"m365 aad app add --name 'My single-page app' --platform spa --redirectUris 'https://myspa.azurewebsites.net,http://localhost'\n")),(0,a.kt)("p",null,"With this one command, CLI for Microsoft 365 will create a new Azure AD application registration and configure its authentication mode to a single-page application with the specified two redirect URLs."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"There are many settings that you can configure for Azure AD app registrations, so be sure to check the ",(0,a.kt)("a",{parentName:"p",href:"/cli-microsoft365-docusaurus/cmd/aad/app/app-add"},"documentation for the ",(0,a.kt)("inlineCode",{parentName:"a"},"m365 aad app add")," command")," for more examples.")),(0,a.kt)("p",null,"This one-liner is great to share with your dev team so that each developer can create their own app registration that they can manage as they work on the app. If your app's configuration is complex, you can also choose to export the existing manifest and create a new Azure AD app registration from it! But there's more."),(0,a.kt)("h2",{id:"step-2-store-information-about-your-azure-ad-app-in-your-project"},"Step 2: Store information about your Azure AD app in your project"),(0,a.kt)("p",null,"As you work with Microsoft 365 apps, you'll be creating quite a few application registrations in Azure AD. Over time, it might be hard for you to keep track of which one is which and where you need to apply changes."),(0,a.kt)("p",null,"To help you, CLI for Microsoft 365 offers you two things. First, when creating an Azure AD app registration for your Microsoft 365 app, store a reference to it. You do this, by extending the ",(0,a.kt)("inlineCode",{parentName:"p"},"m365 aad app add")," command with the ",(0,a.kt)("inlineCode",{parentName:"p"},"--save")," flag:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"m365 aad app add --name 'My single-page app' --platform spa --redirectUris 'https://myspa.azurewebsites.net,http://localhost' --save\n")),(0,a.kt)("p",null,"When you use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--save")," flag, CLI for Microsoft 365 will create the ",(0,a.kt)("inlineCode",{parentName:"p"},".m365rc.json")," file in the current working directory and write to it the ID and name of the newly created Azure AD app registration. If the file exists already, CLI for Microsoft 365 will add the new information to it. That way you can track which Azure AD app registration belongs to your project without having to manually locate them in the Azure Portal! And if you're building complex solutions with multiple Azure AD apps, you can keep track of all of them in one place too!"),(0,a.kt)("p",null,"After you stored the reference to your Azure AD apps in your projects, you're ready to use the ",(0,a.kt)("inlineCode",{parentName:"p"},"app")," commands from CLI for Microsoft 365."),(0,a.kt)("h2",{id:"step-3-manage-azure-ad-app-registrations-for-microsoft-365-apps"},"Step 3: Manage Azure AD app registrations for Microsoft 365 apps"),(0,a.kt)("p",null,"CLI for Microsoft 365 exposes a set of ",(0,a.kt)("inlineCode",{parentName:"p"},"app")," commands (",(0,a.kt)("inlineCode",{parentName:"p"},"m365 app *"),") that let you manage your Microsoft 365 app projects. For example, using the ",(0,a.kt)("a",{parentName:"p",href:"/cli-microsoft365-docusaurus/cmd/app/permission/permission-list"},(0,a.kt)("inlineCode",{parentName:"a"},"m365 app permission list"))," command, you can easily retrieve API permissions for your AAD app."),(0,a.kt)("p",null,"See the list of ",(0,a.kt)("inlineCode",{parentName:"p"},"app")," commands in the ",(0,a.kt)("strong",{parentName:"p"},"Commands")," section of this documentation for the complete reference of supported operations."))}m.isMDXComponent=!0}}]);