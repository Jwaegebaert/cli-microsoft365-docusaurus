"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7969],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var n=r(67294);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var l=n.createContext({}),m=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=m(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=m(r),d=s,f=p["".concat(l,".").concat(d)]||p[d]||u[d]||a;return r?n.createElement(f,o(o({ref:t},c),{},{components:r})):n.createElement(f,o({ref:t},c))}));function f(e,t){var r=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=r.length,o=new Array(a);o[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:s,o[1]=i;for(var m=2;m<a;m++)o[m]=r[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},51549:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>m});var n=r(87462),s=(r(67294),r(3905));const a={tags:["provisioning","users"]},o="Bulk add members to Microsoft Teams team from CSV file",i={unversionedId:"sample-scripts/teams/add-bulk-users-teams/index",id:"sample-scripts/teams/add-bulk-users-teams/index",title:"Bulk add members to Microsoft Teams team from CSV file",description:"Inspired by: Rakesh Pandey",source:"@site/docs/sample-scripts/teams/add-bulk-users-teams/index.md",sourceDirName:"sample-scripts/teams/add-bulk-users-teams",slug:"/sample-scripts/teams/add-bulk-users-teams/",permalink:"/sample-scripts/teams/add-bulk-users-teams/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/teams/add-bulk-users-teams/index.md",tags:[{label:"provisioning",permalink:"/tags/provisioning"},{label:"users",permalink:"/tags/users"}],version:"current",lastUpdatedBy:"Jwaegebaert",lastUpdatedAt:1672784370,formattedLastUpdatedAt:"Jan 3, 2023",frontMatter:{tags:["provisioning","users"]},sidebar:"sampleScripts",previous:{title:"Microsoft Teams",permalink:"/sample-script/teams"},next:{title:"Create a Microsoft Teams team and bulk add members from CSV file",permalink:"/sample-scripts/teams/create-team-and-add-members-and-owners/"}},l={},m=[],c={toc:m};function p(e){let{components:t,...r}=e;return(0,s.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"bulk-add-members-to-microsoft-teams-team-from-csv-file"},"Bulk add members to Microsoft Teams team from CSV file"),(0,s.kt)("p",null,"Inspired by: ",(0,s.kt)("a",{parentName:"p",href:"https://www.flexmind.co/blog/how-to-add-bulk-users-from-csv-file-to-ms-teams-using-powershell/"},"Rakesh Pandey")),(0,s.kt)("p",null,'=== "PowerShell"'),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'```powershell\n<#\n.SYNOPSIS\n    Add users to a Microsoft 365 group linked to Teams.\n.DESCRIPTION\n    This script will add users in existing Teams contained in your .csv file.\n.EXAMPLE\n    PS C:\\> .\\add-users-teams.ps1\n    This script will add users in existing Microsoft Teams teams from your .csv file\n.INPUTS\n    Inputs (if any)\n.OUTPUTS\n    Output (if any)\n.NOTES\n    Your .csv file must contain headers called UPN, teamName, teamId, and role. If you change those headers then make sure to amend the script.\n#>\n\n#Check if connected to M365\n$m365Status = m365 status --output text\nif ($m365Status -eq "Logged Out") {\n  m365 login\n}\n    \n#Import csv\n$usersCsvFile = Import-Csv -Path "<YOUR_CSVFile_PATH_HERE.csv>"\n\n#Add users to the Team\nforeach ($row in $usersCsvFile) {\n  Write-Host "Adding $($row.UPN) to the $($row.teamName) Team" -ForegroundColor Magenta\n  m365 aad o365group user add --groupId $row.teamId --userName $($row.UPN) --role $($row.role)\n}\n```\n')))}p.isMDXComponent=!0}}]);