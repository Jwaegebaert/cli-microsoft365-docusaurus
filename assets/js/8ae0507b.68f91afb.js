"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[91049],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>k});var o=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=o.createContext({}),l=function(e){var t=o.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=l(e.components);return o.createElement(i.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),c=l(a),u=n,k=c["".concat(i,".").concat(u)]||c[u]||m[u]||r;return a?o.createElement(k,s(s({ref:t},d),{},{components:a})):o.createElement(k,s({ref:t},d))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=u;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p[c]="string"==typeof e?e:n,s[1]=p;for(var l=2;l<r;l++)s[l]=a[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,a)}u.displayName="MDXCreateElement"},26054:(e,t,a)=>{a.d(t,{ZP:()=>p});var o=a(87462),n=(a(67294),a(3905));const r={toc:[]},s="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(s,(0,o.Z)({},r,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("dl",null,(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-h, --help [help]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Output usage information. Optionally, specify which section of command's help you want to see. Allowed values are ",(0,n.kt)("code",{parentName:"p"},"options"),", ",(0,n.kt)("code",{parentName:"p"},"examples"),", ",(0,n.kt)("code",{parentName:"p"},"remarks"),", ",(0,n.kt)("code",{parentName:"p"},"response"),", ",(0,n.kt)("code",{parentName:"p"},"full"),". Default is ",(0,n.kt)("code",{parentName:"p"},"full"),".")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--query [query]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"JMESPath query string. See ",(0,n.kt)("a",{parentName:"p",href:"http://jmespath.org/"},"http://jmespath.org/")," for more information and examples.")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-o, --output [output]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Output type. ",(0,n.kt)("code",{parentName:"p"},"json"),", ",(0,n.kt)("code",{parentName:"p"},"text"),", ",(0,n.kt)("code",{parentName:"p"},"csv"),", ",(0,n.kt)("code",{parentName:"p"},"md"),". Default ",(0,n.kt)("code",{parentName:"p"},"json"),".")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--verbose"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Runs command with verbose logging.")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--debug"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Runs command with debug logging."))))}p.isMDXComponent=!0},95577:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>p,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var o=a(87462),n=(a(67294),a(3905)),r=a(26054);const s={},p="spo site set",i={unversionedId:"cmd/spo/site/site-set",id:"cmd/spo/site/site-set",title:"spo site set",description:"Updates properties of the specified site",source:"@site/docs/cmd/spo/site/site-set.mdx",sourceDirName:"cmd/spo/site",slug:"/cmd/spo/site/site-set",permalink:"/cli-microsoft365-docusaurus/cmd/spo/site/site-set",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/cmd/spo/site/site-set.mdx",tags:[],version:"current",lastUpdatedAt:1685107590,formattedLastUpdatedAt:"May 26, 2023",frontMatter:{},sidebar:"commands",previous:{title:"spo site rename",permalink:"/cli-microsoft365-docusaurus/cmd/spo/site/site-rename"},next:{title:"spo site appcatalog add",permalink:"/cli-microsoft365-docusaurus/cmd/spo/site/site-appcatalog-add"}},l={},d=[{value:"Usage",id:"usage",level:2},{value:"Options",id:"options",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Examples",id:"examples",level:2}],c={toc:d},m="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(m,(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"spo-site-set"},"spo site set"),(0,n.kt)("p",null,"Updates properties of the specified site"),(0,n.kt)("h2",{id:"usage"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set [options]\n")),(0,n.kt)("h2",{id:"options"},"Options"),(0,n.kt)("dl",null,(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-u, --url <url>"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The URL of the site collection to update")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-t, --title [title]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The new title for the site collection")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"-d, --description [description]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The site description")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--classification [classification]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The new classification for the site collection")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--disableFlows [disableFlows]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Set to ",(0,n.kt)("code",{parentName:"p"},"true")," to disable using Microsoft Flow in this site collection")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--isPublic [isPublic]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Set to ",(0,n.kt)("code",{parentName:"p"},"true")," to make the group linked to the site public or to ",(0,n.kt)("code",{parentName:"p"},"false")," to make it private")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--owners [owners]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Comma-separated list of users to add as site collection administrators")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--shareByEmailEnabled [shareByEmailEnabled]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Set to true to allow to share files with guests and to false to disallow it")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--siteDesignId [siteDesignId]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Id of the custom site design to apply to the site")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--sharingCapability [sharingCapability]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The sharing capability for the site. Allowed values:  ",(0,n.kt)("code",{parentName:"p"},"Disabled"),", ",(0,n.kt)("code",{parentName:"p"},"ExternalUserSharingOnly"),", ",(0,n.kt)("code",{parentName:"p"},"ExternalUserAndGuestSharing"),", ",(0,n.kt)("code",{parentName:"p"},"ExistingExternalUserSharingOnly"),".")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--siteLogoUrl [siteLogoUrl]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Set the logo for the site collection. This can be an absolute or relative URL to a file on the current site collection.")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--resourceQuota [resourceQuota]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The quota for this site collection in Sandboxed Solutions units")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--resourceQuotaWarningLevel [resourceQuotaWarningLevel]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The warning level for the resource quota")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--storageQuota [storageQuota]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The storage quota for this site collection in megabytes")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--storageQuotaWarningLevel [storageQuotaWarningLevel]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"The warning level for the storage quota in megabytes")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--allowSelfServiceUpgrade [allowSelfServiceUpgrade]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Set to allow tenant administrators to upgrade the site collection")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--lockState [lockState]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Sets site's lock state. Allowed values ",(0,n.kt)("code",{parentName:"p"},"Unlock"),", ",(0,n.kt)("code",{parentName:"p"},"NoAdditions"),", ",(0,n.kt)("code",{parentName:"p"},"ReadOnly"),", ",(0,n.kt)("code",{parentName:"p"},"NoAccess"))),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--noScriptSite [noScriptSite]"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Specifies if the site allows custom script or not")),(0,n.kt)("dt",{parentName:"dl"},(0,n.kt)("p",{parentName:"dt"},(0,n.kt)("code",{parentName:"p"},"--wait"))),(0,n.kt)("dd",{parentName:"dl"},(0,n.kt)("p",{parentName:"dd"},"Wait for the settings to be applied before completing the command"))),(0,n.kt)(r.ZP,{mdxType:"Global"}),(0,n.kt)("h2",{id:"remarks"},"Remarks"),(0,n.kt)("p",null,"If the specified url doesn't refer to an existing site collection, you will get a ",(0,n.kt)("inlineCode",{parentName:"p"},'404 - "404 FILE NOT FOUND"')," error."),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"isPublic")," property can be set only on groupified site collections. If you try to set it on a site collection without a group, you will get an error."),(0,n.kt)("p",null,"When setting owners, the specified owners will be added to the already configured owners. Existing owners will not be removed."),(0,n.kt)("p",null,"The value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--resourceQuota")," option must not exceed the company's aggregate available Sandboxed Solutions quota. For more information, see Resource Usage Limits on Sandboxed Solutions in SharePoint 2010: ",(0,n.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/en-us/library/gg615462.aspx"},"http://msdn.microsoft.com/en-us/library/gg615462.aspx"),"."),(0,n.kt)("p",null,"The value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--resourceQuotaWarningLevel")," option must not exceed the value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--resourceQuota")," option or the current value of the ",(0,n.kt)("em",{parentName:"p"},"UserCodeMaximumLevel")," property."),(0,n.kt)("p",null,"The value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--storageQuota")," option must not exceed the company's available quota."),(0,n.kt)("p",null,"The value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--storageQuotaWarningLevel")," option must not exceed the the value of the ",(0,n.kt)("inlineCode",{parentName:"p"},"--storageQuota")," option or the current value of the ",(0,n.kt)("em",{parentName:"p"},"StorageMaximumLevel")," property."),(0,n.kt)("p",null,"For more information on locking sites see ",(0,n.kt)("a",{parentName:"p",href:"https://technet.microsoft.com/en-us/library/cc263238.aspx"},"https://technet.microsoft.com/en-us/library/cc263238.aspx"),"."),(0,n.kt)("p",null,"For more information on configuring no script sites see ",(0,n.kt)("a",{parentName:"p",href:"https://support.office.com/en-us/article/Turn-scripting-capabilities-on-or-off-1f2c515f-5d7e-448a-9fd7-835da935584f"},"https://support.office.com/en-us/article/Turn-scripting-capabilities-on-or-off-1f2c515f-5d7e-448a-9fd7-835da935584f"),"."),(0,n.kt)("p",null,"Setting site properties is by default asynchronous and depending on the current state of Microsoft 365, might take up to few minutes. If you're building a script with steps that require the site to be fully configured, you should use the ",(0,n.kt)("inlineCode",{parentName:"p"},"--wait")," flag. When using this flag, the ",(0,n.kt)("inlineCode",{parentName:"p"},"spo site set")," command will keep running until it received confirmation from Microsoft 365 that the site has been fully configured."),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"To use this command you have to have permissions to access the tenant admin site.")),(0,n.kt)("h2",{id:"examples"},"Examples"),(0,n.kt)("p",null,"Update site collection's classification"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --classification MBI\n")),(0,n.kt)("p",null,"Reset site collection's classification."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --classification\n")),(0,n.kt)("p",null,"Disable using Microsoft Flow on the site collection"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --disableFlows true\n")),(0,n.kt)("p",null,"Update the visibility of the Microsoft 365 group behind the specified groupified site collection to public"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --isPublic true\n")),(0,n.kt)("p",null,"Update site collection's owners"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --owners "john@contoso.onmicrosoft.com,steve@contoso.onmicrosoft.com"\n')),(0,n.kt)("p",null,"Allow sharing files in the site collection with guests"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --shareByEmailEnabled true\n")),(0,n.kt)("p",null,"Apply the specified site ID to the site collection"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --siteDesignId "eb2f31da-9461-4fbf-9ea1-9959b134b89e"\n')),(0,n.kt)("p",null,"Update site collection's title"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --title "My new site"\n')),(0,n.kt)("p",null,"Update site collection's description"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --description "my description"\n')),(0,n.kt)("p",null,"Restrict external sharing to already available external users only"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/sales --sharingCapability ExistingExternalUserSharingOnly\n")),(0,n.kt)("p",null,"Set the logo on the site"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --siteLogoUrl "/sites/sales/SiteAssets/parker-ms-1200.png"\n')),(0,n.kt)("p",null,"Unset the logo on the site"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'m365 spo site set --url https://contoso.sharepoint.com/sites/sales --siteLogoUrl ""\n')),(0,n.kt)("p",null,"Lock the site preventing users from accessing it. Wait for the configuration to complete"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"m365 spo site set --url https://contoso.sharepoint.com/sites/team --LockState NoAccess --wait\n")))}u.isMDXComponent=!0}}]);