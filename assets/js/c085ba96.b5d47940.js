"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[97548],{3905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>f});var a=t(67294);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e,r){if(null==e)return{};var t,a,n=function(e,r){if(null==e)return{};var t,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var l=a.createContext({}),i=function(e){var r=a.useContext(l),t=r;return e&&(t="function"==typeof e?e(r):s(s({},r),e)),t},c=function(e){var r=i(e.components);return a.createElement(l.Provider,{value:r},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},d=a.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),m=i(t),d=n,f=m["".concat(l,".").concat(d)]||m[d]||p[d]||o;return t?a.createElement(f,s(s({ref:r},c),{},{components:t})):a.createElement(f,s({ref:r},c))}));function f(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,s=new Array(o);s[0]=d;var u={};for(var l in r)hasOwnProperty.call(r,l)&&(u[l]=r[l]);u.originalType=e,u[m]="string"==typeof e?e:n,s[1]=u;for(var i=2;i<o;i++)s[i]=t[i];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},85162:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(67294),n=t(86010);const o={tabItem:"tabItem_Ymn6"};function s(e){let{children:r,hidden:t,className:s}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(o.tabItem,s),hidden:t},r)}},74866:(e,r,t)=>{t.d(r,{Z:()=>$});var a=t(87462),n=t(67294),o=t(86010),s=t(12466),u=t(56697),l=t(91980),i=t(67392),c=t(50012);function m(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:r,label:t,attributes:a,default:n}}=e;return{value:r,label:t,attributes:a,default:n}}))}function p(e){const{values:r,children:t}=e;return(0,n.useMemo)((()=>{const e=r??m(t);return function(e){const r=(0,i.l)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function d(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function f(e){let{queryString:r=!1,groupId:t}=e;const a=(0,u.k6)(),o=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,l._X)(o),(0,n.useCallback)((e=>{if(!o)return;const r=new URLSearchParams(a.location.search);r.set(o,e),a.replace({...a.location,search:r.toString()})}),[o,a])]}function g(e){const{defaultValue:r,queryString:t=!1,groupId:a}=e,o=p(e),[s,u]=(0,n.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!d({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:r,tabValues:o}))),[l,i]=f({queryString:t,groupId:a}),[m,g]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[a,o]=(0,c.Nk)(t);return[a,(0,n.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:a}),b=(()=>{const e=l??m;return d({value:e,tabValues:o})?e:null})();(0,n.useLayoutEffect)((()=>{b&&u(b)}),[b]);return{selectedValue:s,selectValue:(0,n.useCallback)((e=>{if(!d({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);u(e),i(e),g(e)}),[i,g,o]),tabValues:o}}var b=t(72389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function v(e){let{className:r,block:t,selectedValue:u,selectValue:l,tabValues:i}=e;const c=[],{blockElementScrollPositionUntilNextRender:m}=(0,s.o5)(),p=e=>{const r=e.currentTarget,t=c.indexOf(r),a=i[t].value;a!==u&&(m(r),l(a))},d=e=>{let r=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;r=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;r=c[t]??c[c.length-1];break}}r?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":t},r)},i.map((e=>{let{value:r,label:t,attributes:s}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:u===r?0:-1,"aria-selected":u===r,key:r,ref:e=>c.push(e),onKeyDown:d,onClick:p},s,{className:(0,o.Z)("tabs__item",h.tabItem,s?.className,{"tabs__item--active":u===r})}),t??r)})))}function y(e){let{lazy:r,children:t,selectedValue:a}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=o.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},o.map(((e,r)=>(0,n.cloneElement)(e,{key:r,hidden:e.props.value!==a}))))}function k(e){const r=g(e);return n.createElement("div",{className:(0,o.Z)("tabs-container",h.tabList)},n.createElement(v,(0,a.Z)({},e,r)),n.createElement(y,(0,a.Z)({},e,r)))}function $(e){const r=(0,b.Z)();return n.createElement(k,(0,a.Z)({key:String(r)},e))}},64844:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>l,default:()=>f,frontMatter:()=>u,metadata:()=>i,toc:()=>m});var a=t(87462),n=(t(67294),t(3905)),o=t(74866),s=t(85162);const u={tags:["groups","security","teams","users"]},l="Bulk add/remove users to Microsoft Teams and Microsoft 365 Groups",i={unversionedId:"sample-scripts/aad/manage-group-users/index",id:"sample-scripts/aad/manage-group-users/index",title:"Bulk add/remove users to Microsoft Teams and Microsoft 365 Groups",description:"Author: Joseph Velliah",source:"@site/docs/sample-scripts/aad/manage-group-users/index.mdx",sourceDirName:"sample-scripts/aad/manage-group-users",slug:"/sample-scripts/aad/manage-group-users/",permalink:"/cli-microsoft365-docusaurus/sample-scripts/aad/manage-group-users/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/aad/manage-group-users/index.mdx",tags:[{label:"groups",permalink:"/cli-microsoft365-docusaurus/tags/groups"},{label:"security",permalink:"/cli-microsoft365-docusaurus/tags/security"},{label:"teams",permalink:"/cli-microsoft365-docusaurus/tags/teams"},{label:"users",permalink:"/cli-microsoft365-docusaurus/tags/users"}],version:"current",lastUpdatedAt:1683143859,formattedLastUpdatedAt:"May 3, 2023",frontMatter:{tags:["groups","security","teams","users"]},sidebar:"sampleScripts",previous:{title:"Scan for Microsoft 365 Groups created with user's first or last name",permalink:"/cli-microsoft365-docusaurus/sample-scripts/aad/flag-groups-with-user-names/"},next:{title:"Replace a user's membership in selected Microsoft 365 Groups or Teams",permalink:"/cli-microsoft365-docusaurus/sample-scripts/aad/replace-membership-of-selected-groups/"}},c={},m=[],p={toc:m},d="wrapper";function f(e){let{components:r,...t}=e;return(0,n.kt)(d,(0,a.Z)({},p,t,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"bulk-addremove-users-to-microsoft-teams-and-microsoft-365-groups"},"Bulk add/remove users to Microsoft Teams and Microsoft 365 Groups"),(0,n.kt)("p",null,"Author: ",(0,n.kt)("a",{parentName:"p",href:"https://sprider.blog/add-remove-bulk-users-to-from-microsoft-teams-microsoft-365-group-office-365-cli-commands"},"Joseph Velliah")),(0,n.kt)("p",null,"Companies pursue to hasten profits growth or enter new marketplace through Mergers and Acquisitions (M&A). M&A typically fails during integration. This also applies to migrating users and data in Microsoft Teams and Groups. Partial acquisition can be pretty tricky. To help make the activity as charming as possible, I have created the following sample script to add/remove bulk users to/from Microsoft Teams team or Microsoft 365 group using CLI for Microsoft 365 commands."),(0,n.kt)("p",null,"Note: Refactor the code as per your requirement."),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(s.Z,{value:"PowerShell",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},'$taskItems = import-csv "sample-input-file.csv" \u2013header mailNickname, userEmail, role, action\n$groups = m365 aad o365group list -o json | ConvertFrom-Json\n\nForEach ($taskItem in $taskItems) {\n\n    $mailNickname = $($taskItem.mailNickname)\n    $userEmail = $($taskItem.userEmail)\n    $role = $($taskItem.role)\n    $action = $($taskItem.action)\n\n    $group = $groups | Where-Object { $_.mailNickname -eq "$mailNickname" }\n    $user = m365 aad user get --userName $userEmail -o json | ConvertFrom-Json\n\n    Write-Host "Processing: User --\x3e " $user.mail " Group --\x3e " $group.mailNickname\n\n    If ($action -eq "add") {\n\n        If ($role -eq "owner") {\n            m365 aad o365group user add --groupId $group.id --userName $user.mail --role Owner\n            Write-Host $user.mail " added as owner in " $group.mailNickname\n        }\n        ElseIf ($role -eq "member") {\n            m365 aad o365group user add --groupId $group.id --userName $user.mail\n            Write-Host $user.mail " added as member in " $group.mailNickname\n        }\n        Else {\n            Write-Host "Invalid user role \'" $role "\'"\n        }\n    }\n    ElseIf ($action -eq "remove") {\n        m365 aad o365group user remove --groupId $group.id --userName $user.mail --confirm\n        Write-Host $user.mail " removed from " $group.mailNickname\n    }\n    Else {\n        Write-Host "Invalid task action \'" $action "\'"\n    }\n}\n'))),(0,n.kt)(s.Z,{value:"Input CSV File Format",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csv"},"groupMailNickname1, user1@domainname.com, owner, add\ngroupMailNickname2, user2@domainname.com, member, add\ngroupMailNickname3, user3@domainname.com, , remove\n")))))}f.isMDXComponent=!0}}]);