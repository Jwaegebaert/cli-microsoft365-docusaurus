"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[55880],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var i=a.createContext({}),l=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(i.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,i=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=l(n),m=s,f=c["".concat(i,".").concat(m)]||c[m]||u[m]||r;return n?a.createElement(f,p(p({ref:t},d),{},{components:n})):a.createElement(f,p({ref:t},d))}));function f(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,p=new Array(r);p[0]=m;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[c]="string"==typeof e?e:s,p[1]=o;for(var l=2;l<r;l++)p[l]=n[l];return a.createElement.apply(null,p)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},81594:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>p,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=n(87462),s=(n(67294),n(3905));const r={tags:["apps","provisioning","users"]},p="Deploy Microsoft Teams personal app and add it to users",o={unversionedId:"sample-scripts/teams/install-personal-app/index",id:"sample-scripts/teams/install-personal-app/index",title:"Deploy Microsoft Teams personal app and add it to users",description:"Author: S\xe9bastien Levert",source:"@site/docs/sample-scripts/teams/install-personal-app/index.md",sourceDirName:"sample-scripts/teams/install-personal-app",slug:"/sample-scripts/teams/install-personal-app/",permalink:"/sample-scripts/teams/install-personal-app/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/teams/install-personal-app/index.md",tags:[{label:"apps",permalink:"/tags/apps"},{label:"provisioning",permalink:"/tags/provisioning"},{label:"users",permalink:"/tags/users"}],version:"current",lastUpdatedBy:"Jwaegebaert",lastUpdatedAt:1672784370,formattedLastUpdatedAt:"Jan 3, 2023",frontMatter:{tags:["apps","provisioning","users"]},sidebar:"sampleScripts",previous:{title:"Govern orphaned Microsoft Teams",permalink:"/sample-scripts/teams/govern-orphan-teams/"},next:{title:"List all tabs in Microsoft Teams teams in the tenant",permalink:"/sample-scripts/teams/list-all-tabs-teams/"}},i={},l=[],d={toc:l};function c(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"deploy-microsoft-teams-personal-app-and-add-it-to-users"},"Deploy Microsoft Teams personal app and add it to users"),(0,s.kt)("p",null,"Author: ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/sebastienlevert"},"S\xe9bastien Levert")),(0,s.kt)("p",null,"Installs or updates a Microsoft Teams app from a provided zipped manifest and then, based on the parameters, add it to the current users and / or to a set of users."),(0,s.kt)("p",null,'=== "PowerShell"'),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'```powershell\n<#\n  .SYNOPSIS\n    Installs an app to Microsoft Teams and potentially to a set of users\n  .EXAMPLE\n    .\\Install-PersonalApp.ps1 -AppManifestPath "C:\\_\\Manifest.zip" -AppId "2dbace6f-3f3b-4779-9e3f-bb4d27c403fe" -Publish -Install -CurrentUser\n  .EXAMPLE\n    .\\Install-PersonalApp.ps1 -AppManifestPath "C:\\_\\Manifest.zip" -AppId "2dbace6f-3f3b-4779-9e3f-bb4d27c403fe" -Publish -Update -Install -Users @("user1@contoso.com", "user2@contoso.com")\n  .PARAMETER AppManifestPath\n    Valid Path to an zipped App Manifest representing the Microsoft Teams app\n  .PARAMETER AppId\n    GUID of the Microsoft Teams app. Is the same "id" you can find in the manifest.json from your Microsoft Teams app.\n  .PARAMETER Users\n    Array of string representing the usernames of the users to deploy the Microsoft Teams app to.\n  .PARAMETER Publish\n    Switch allowing to Publish (make available) the application to the tenant app catalog\n  .PARAMETER Update\n    Switch allowing to Update an existing application in the tenant app catalog\n  .PARAMETER Install\n    Switch allowing to Install the app for the specified Users or Current User\n  .PARAMETER CurrentUser\n    Switch allowing to Install the app for the current user\n#>\nParam(\n  [ValidateScript( {\n      if (-not ($_ | Test-Path) ) {\n        throw "File or folder does not exist"\n      }\n      if (-not ($_ | Test-Path -PathType Leaf) ) {\n        throw "The Path argument must be a file. Folder paths are not allowed."\n      }\n      if ($_ -notmatch ".zip") {\n        throw "The file specified in the path argument must be a zip"\n      }\n      return $true\n    })]\n  [System.IO.FileInfo]$AppManifestPath,\n  [string]$AppId,\n  [string[]]$Users,\n  [switch]$Publish,\n  [switch]$Update,\n  [switch]$Install,\n  [switch]$CurrentUser\n)\n\n$m365Status = m365 status --output text\n\nif ($m365Status -eq "Logged Out") {\n  # Connection to Microsoft 365\n  m365 login\n}\n\n# Validating that the app is not already in the store\n$app = m365 teams app list --query "[?externalId == \'$AppId\']" -o json | ConvertFrom-Json\n\nif ($app.Length -gt 0) {\n  if ($Update) {\n    # Updating the app with the provided manifest\n    m365 teams app update --id $app.id --filePath $AppManifestPath\n    $app = m365 teams app list --query "[?externalId == \'$AppId\']" -o json | ConvertFrom-Json\n    Write-Host "The App \'$($app.displayName)\' with ID \'$($app.id)\' and ExternalID \'$($app.externalId)\' was updated."\n  }\n}\nelse {\n  if ($Publish) {\n    # Publishing the app with the provided manifest\n    m365 teams app publish --filePath $AppManifestPath\n    $app = m365 teams app list --query "[?externalId == \'$AppId\']" -o json | ConvertFrom-Json\n    Write-Host "The App \'$($app.displayName)\' with ID \'$($app.id)\' and ExternalID \'$($app.externalId)\' was published."\n  }\n}\n\nif ($CurrentUser) {\n  # Getting the reference of the currently connected user\n  $connectedAs = m365 status -o json | ConvertFrom-Json\n  $user = m365 aad user get --userName $connectedAs.connectedAs -o json | ConvertFrom-Json\n\n  if ($user) {\n    $Users += $user.userPrincipalName\n  }\n}  \n\n$user = $null\nif ($Users.Length -gt 0 -and $Install) {\n  $Users | ForEach-Object {\n    # Getting the specified user\n    $user = m365 aad user get --userName $_ -o json | ConvertFrom-Json\n  \n    if ($user) {\n      $userApp = m365 teams user app list --userId $user.id --query "[?appId == \'$($app.id)\']" -o json | ConvertFrom-Json\n\n      if ($userApp.Length -eq 0) {\n        # Adding the app to the personal apps of the specified user\n        m365 teams user app add --appId $app.id --userId $user.id\n        Write-Host "The App \'$($app.displayName)\' with ID \'$($app.id)\' was deployed to user \'$($user.userPrincipalName)\'."\n\n      }\n      else {\n        Write-Warning "The App \'$($app.displayName)\' with ID \'$($app.id)\' is already deployed to user \'$($user.userPrincipalName)\'."\n      }\n    }\n    else {\n      Write-Warning "The user \'$_\' was not found"\n    }\n  }\n}\n```\n')))}c.isMDXComponent=!0}}]);