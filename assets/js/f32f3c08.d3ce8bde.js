"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[60100],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>d});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,p=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=s(n),u=o,d=c["".concat(p,".").concat(u)]||c[u]||f[u]||l;return n?r.createElement(d,a(a({ref:t},m),{},{components:n})):r.createElement(d,a({ref:t},m))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,a=new Array(l);a[0]=u;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[c]="string"==typeof e?e:o,a[1]=i;for(var s=2;s<l;s++)a[s]=n[s];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2170:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var r=n(87462),o=(n(67294),n(3905));const l={tags:["flows","migration"]},a="Export all flows in environment",i={unversionedId:"sample-scripts/flow/export-all-flows-in-environment/index",id:"sample-scripts/flow/export-all-flows-in-environment/index",title:"Export all flows in environment",description:"Author: Garry Trinder",source:"@site/docs/sample-scripts/flow/export-all-flows-in-environment/index.md",sourceDirName:"sample-scripts/flow/export-all-flows-in-environment",slug:"/sample-scripts/flow/export-all-flows-in-environment/",permalink:"/sample-scripts/flow/export-all-flows-in-environment/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/flow/export-all-flows-in-environment/index.md",tags:[{label:"flows",permalink:"/tags/flows"},{label:"migration",permalink:"/tags/migration"}],version:"current",lastUpdatedBy:"Jwaegebaert",lastUpdatedAt:1672784370,formattedLastUpdatedAt:"Jan 3, 2023",frontMatter:{tags:["flows","migration"]},sidebar:"sampleScripts",previous:{title:"Cancel all running flow runs for a flow in an environment",permalink:"/sample-scripts/flow/cancel-all-running-flow-runs/"},next:{title:"Export a single flow to a Logic App",permalink:"/sample-scripts/flow/export-flow-logicapp/"}},p={},s=[],m={toc:s};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"export-all-flows-in-environment"},"Export all flows in environment"),(0,o.kt)("p",null,"Author: ",(0,o.kt)("a",{parentName:"p",href:"https://garrytrinder.github.io/2021/01/export-all-flows-from-environment-cli-microsoft365"},"Garry Trinder")),(0,o.kt)("p",null,"When was the last time you backed up all the flows in your environment?"),(0,o.kt)("p",null,"By combining the CLI for Microsoft 365 and PowerShell we can make this task easy and repeatable."),(0,o.kt)("p",null,"This script will get all flows in your default environment and export them as both a ZIP file for importing back into Power Automate and as a JSON file for importing into Azure as an Azure Logic App."),(0,o.kt)("p",null,'=== "PowerShell"'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'```powershell\nWrite-Output "Getting environment info..."\n$environment = m365 flow environment list --query \'[?properties.isDefault==`true`].name\' --output json | ConvertFrom-JSON\n\nWrite-Output "Getting Flows info..."\n$flows = m365 flow list --environment $environment --asAdmin --output json | ConvertFrom-JSON\n\nWrite-Output "Found $($flows.Count) Flows to export..."\n\n$flows | ForEach-Object {\n    Write-Output "Exporting as ZIP & JSON... $($_.displayName)"\n    $filename = $_.displayName.Replace(" ","")\n    $timestamp = Get-Date -Format "yyyymmddhhmmss"\n    $exportPath = "$($filename)_$($timestamp)"\n    $flowId = $_.Name\n    \n    m365 flow export --id $flowId --environment $environment --packageDisplayName $_.displayName --path "$exportPath.zip"\n    m365 flow export --id $flowId --environment $environment --format json --path "$exportPath.json"\n}\n\nWrite-Output "Complete"\n```\n')))}c.isMDXComponent=!0}}]);