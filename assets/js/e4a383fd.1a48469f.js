"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[92467],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var s=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},i=Object.keys(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=s.createContext({}),l=function(e){var t=s.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return s.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},m=s.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=l(n),m=r,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return n?s.createElement(g,o(o({ref:t},c),{},{components:n})):s.createElement(g,o({ref:t},c))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var a={};for(var p in t)hasOwnProperty.call(t,p)&&(a[p]=t[p]);a.originalType=e,a[d]="string"==typeof e?e:r,o[1]=a;for(var l=2;l<i;l++)o[l]=n[l];return s.createElement.apply(null,o)}return s.createElement.apply(null,n)}m.displayName="MDXCreateElement"},26077:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var s=n(87462),r=(n(67294),n(3905));const i={tags:["cleanup"]},o="Delete custom SharePoint site designs",a={unversionedId:"sample-scripts/spo/remove-site-designs/index",id:"sample-scripts/spo/remove-site-designs/index",title:"Delete custom SharePoint site designs",description:"Author: Laura Kokkarinen",source:"@site/docs/sample-scripts/spo/remove-site-designs/index.md",sourceDirName:"sample-scripts/spo/remove-site-designs",slug:"/sample-scripts/spo/remove-site-designs/",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/remove-site-designs/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/spo/remove-site-designs/index.md",tags:[{label:"cleanup",permalink:"/cli-microsoft365-docusaurus/tags/cleanup"}],version:"current",lastUpdatedAt:1671570658,formattedLastUpdatedAt:"Dec 20, 2022",frontMatter:{tags:["cleanup"]},sidebar:"sampleScripts",previous:{title:"Remove pending SharePoint API permission requests",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/remove-pending-api-permission-requests/"},next:{title:"Delete custom SharePoint site scripts",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/remove-site-scripts/"}},p={},l=[],c={toc:l},d="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,s.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"delete-custom-sharepoint-site-designs"},"Delete custom SharePoint site designs"),(0,r.kt)("p",null,"Author: ",(0,r.kt)("a",{parentName:"p",href:"https://laurakokkarinen.com/does-it-spark-joy-powershell-scripts-for-keeping-your-development-environment-tidy-and-spotless/#delete-all-sharepoint-site-designs-and-site-scripts"},"Laura Kokkarinen")),(0,r.kt)("p",null,"Site designs and especially site scripts can be something that ends up just hanging around in your tenant for a long time even though you no longer need them for anything. Use the scripts below to get rid of them. You might also find some site scripts that are not linked to any site design and hence never get executed!"),(0,r.kt)("p",null,'=== "PowerShell"'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```powershell\n$sparksjoy = "Cat Lovers United", "Multicolored theme"\n$sitedesigns = m365 spo sitedesign list -o json | ConvertFrom-Json\n$sitedesigns = $sitedesigns | where {-not ($sparksjoy -contains $_.Title)}\n$sitedesigns | Format-Table Title, SiteScriptIds, Description\nif ($sitedesigns.Count -eq 0) { break }\nRead-Host -Prompt "Press Enter to start deleting (CTRL + C to exit)"\n$progress = 0\n$total = $sitedesigns.Count\nforeach ($sitedesign in $sitedesigns)\n{\n  $progress++\n  write-host $progress / $total":" $sitedesign.Title\n  m365 spo sitedesign remove --id "$($sitedesign.Id)" --confirm\n}\n```\n')),(0,r.kt)("p",null,'=== "Bash"'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```bash\n#!/bin/bash\n\n# requires jq: https://stedolan.github.io/jq/\n\nsparksjoy=("Cat Lovers United" "Multicolored theme")\nsitedesignstoremove=()\nwhile read sitedesign; do\n  exists=false\n  designinfo=(${sitedesign//;/ })\n  for keep in "${sparksjoy[@]}"; do\n    if [ "$keep" == "${designinfo[0]}" ] ; then\n      exists=true\n      break\n    fi\n  done\n  if [ "$exists" = false ]; then\n    sitedesignstoremove+=("$sitedesign")\n  fi\ndone < <(m365 spo sitedesign list -o json | jq -r \'.[].Title + ";" + .[].Id\')\n\nif [ ${#sitedesignstoremove[@]} = 0 ]; then\n  exit 1\nfi\n\nprintf \'%s\\n\' "${sitedesignstoremove[@]}"\necho "Press Enter to start deleting (CTRL + C to exit)"\nread foo\n\nfor sitedesign in "${sitedesignstoremove[@]}"; do\n  designinfo=(${sitedesign//;/ })\n  echo "Deleting ${designinfo[0]}..."\n  m365 spo sitedesign remove --id "${designinfo[1]}" --confirm\ndone\n```\n')))}u.isMDXComponent=!0}}]);