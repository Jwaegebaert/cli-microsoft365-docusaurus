"use strict";(self.webpackChunkcli_for_microsoft_365_docs=self.webpackChunkcli_for_microsoft_365_docs||[]).push([[26979],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(n),m=r,f=p["".concat(l,".").concat(m)]||p[m]||d[m]||a;return n?i.createElement(f,s(s({ref:t},c),{},{components:n})):i.createElement(f,s({ref:t},c))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:r,s[1]=o;for(var u=2;u<a;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(67294),r=n(86010);const a={tabItem:"tabItem_Ymn6"};function s(e){let{children:t,hidden:n,className:s}=e;return i.createElement("div",{role:"tabpanel",className:(0,r.Z)(a.tabItem,s),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>k});var i=n(87462),r=n(67294),a=n(86010),s=n(12466),o=n(56697),l=n(91980),u=n(67392),c=n(50012);function p(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:i,default:r}}=e;return{value:t,label:n,attributes:i,default:r}}))}function d(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const i=(0,o.k6)(),a=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(a),(0,r.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(i.location.search);t.set(a,e),i.replace({...i.location,search:t.toString()})}),[a,i])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:i}=e,a=d(e),[s,o]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const i=n.find((e=>e.default))??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:t,tabValues:a}))),[l,u]=f({queryString:n,groupId:i}),[p,h]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[i,a]=(0,c.Nk)(n);return[i,(0,r.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:i}),g=(()=>{const e=l??p;return m({value:e,tabValues:a})?e:null})();(0,r.useLayoutEffect)((()=>{g&&o(g)}),[g]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),h(e)}),[u,h,a]),tabValues:a}}var g=n(72389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:n,selectedValue:o,selectValue:l,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,s.o5)(),d=e=>{const t=e.currentTarget,n=c.indexOf(t),i=u[n].value;i!==o&&(p(t),l(i))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:s}=e;return r.createElement("li",(0,i.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},s,{className:(0,a.Z)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":o===t})}),n??t)})))}function I(e){let{lazy:t,children:n,selectedValue:i}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i}))))}function v(e){const t=h(e);return r.createElement("div",{className:(0,a.Z)("tabs-container",b.tabList)},r.createElement(y,(0,i.Z)({},e,t)),r.createElement(I,(0,i.Z)({},e,t)))}function k(e){const t=(0,g.Z)();return r.createElement(v,(0,i.Z)({key:String(t)},e))}},75407:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>f,frontMatter:()=>o,metadata:()=>u,toc:()=>p});var i=n(87462),r=(n(67294),n(3905)),a=n(74866),s=n(85162);const o={tags:["compliance"]},l="Detecting PII exists in SharePoint List using AWS Comprehend",u={unversionedId:"sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/index",id:"sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/index",title:"Detecting PII exists in SharePoint List using AWS Comprehend",description:"Author: Joseph Velliah",source:"@site/docs/sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/index.mdx",sourceDirName:"sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column",slug:"/sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/",draft:!1,editUrl:"https://github.com/pnp/cli-microsoft365/blob/main/docs/docs/sample-scripts/spo/detecting-pii-exists-in-sharepointlist-column/index.mdx",tags:[{label:"compliance",permalink:"/cli-microsoft365-docusaurus/tags/compliance"}],version:"current",lastUpdatedAt:1685025201,formattedLastUpdatedAt:"May 25, 2023",frontMatter:{tags:["compliance"]},sidebar:"sampleScripts",previous:{title:"Delete custom SharePoint site scripts",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/delete-site-scripts/"},next:{title:"Disable specified Tenant-wide Extension",permalink:"/cli-microsoft365-docusaurus/sample-scripts/spo/disable-tenant-wide-extension/"}},c={},p=[],d={toc:p},m="wrapper";function f(e){let{components:t,...o}=e;return(0,r.kt)(m,(0,i.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"detecting-pii-exists-in-sharepoint-list-using-aws-comprehend"},"Detecting PII exists in SharePoint List using AWS Comprehend"),(0,r.kt)("p",null,"Author: ",(0,r.kt)("a",{parentName:"p",href:"https://blog.josephvelliah.com/detecting-pii-exist-in-sharepoint-list-using-aws-comprehend"},"Joseph Velliah")),(0,r.kt)("p",null,"Personally Identifiable Information (PII) is information that, when used alone or with other relevant data, can identify an individual. Sensitive personally identifiable information can include full name, SSN, driver\u2019s license, financial information and medical records. As PII can be used to identify an individual, signify a major threat to companies. If breached, this information can lead to lawsuits and can damage company\u2019s trustworthiness."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://aws.amazon.com/comprehend/"},"Amazon Comprehend")," is a natural-language processing (NLP) service that uses machine learning to uncover valuable insights and connections in text and documents. We can now use Amazon Comprehend to protect and control who has access to sensitive data by identifying and redacting Personally Identifiable Information (PII) from text and documents."),(0,r.kt)("p",null,"Also, we can redact documents(stored in an Amazon S3 bucket) by using Amazon Comprehend asynchronous analysis job. We can choose redaction mode Replace to mask PII entity with character and replace the characters in PII entities with a symbol(!, #, $, %, &, ","*",", or @). Asynchronous PII redaction batch processing will be a great use case for SharePoint Document Libraries."),(0,r.kt)("p",null,"In this post, I showcased using Amazon Comprehend to detect PII entities from a specific SharePoint List column and record the results in another list and CSV report via the AWS CLI and CLI for Microsoft 365. Take a look at this script, give it a try, and please send me your feedback via the contact page."),(0,r.kt)("p",null,"Thank you, ",(0,r.kt)("a",{parentName:"p",href:"https://aws.amazon.com/blogs/machine-learning/detecting-and-redacting-pii-using-amazon-comprehend/"},"Sriharsha M S"),", for your valuable article on this topic."),(0,r.kt)("p",null,"Prerequisites:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://pnp.github.io/cli-microsoft365/"},"CLI for Microsoft 365")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://aws.amazon.com/cli/"},"AWS CLI")),(0,r.kt)("li",{parentName:"ul"},"SharePoint Online Lists(as shown in screenshots)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"PII List: Items containing dummy/real PII data"),(0,r.kt)("li",{parentName:"ul"},"PII Audit: To store the PII Audit audit detials"))),(0,r.kt)("li",{parentName:"ul"},"Necessary permission to access SharePoint Lists, Amazon Comprehend, and to write CSV files in local machine via")),(0,r.kt)("p",null,"Source & Target Lists:"),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(12847).Z},(0,r.kt)("img",{alt:"pii-source-list",src:n(54974).Z,width:"1080",height:"301"}))),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(69543).Z},(0,r.kt)("img",{alt:"pii-audit-report-list-schema",src:n(37365).Z,width:"883",height:"216"}))),(0,r.kt)(a.Z,{mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"PowerShell",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-powershell"},'$spolHostName = "https://tenant-name.sharepoint.com"\n$spolSiteRelativeUrl = "/sites/site-name"\n$spolListToAuditTitle = "PII List"\n$spolListToSaveAuditResponse = "PII Audit"\n$spolListFields = "ID,Title,Content"\n$resultDir = "Output"\n$executionDir = $PSScriptRoot\n$outputDir = "$executionDir/$resultDir"\n\nif (-not (Test-Path -Path "$outputDir" -PathType Container)) {\n    Write-Host "Creating $outputDir folder..." -ForegroundColor Yellow\n    New-Item -ItemType Directory -Path "$outputDir"\n}\n\n$spolSiteUrl = "${spolHostName}${spolSiteRelativeUrl}"\n$spolListItems = m365 spo listitem list --listTitle $spolListToAuditTitle --webUrl $spolSiteUrl --fields $spolListFields -o json | ConvertFrom-Json -AsHashtable\n\nif ($spolListItems.Count -gt 0) {\n    ForEach ($spolListItem in $spolListItems) {\n        $spolListItemId = $spolListItem.Id\n        $spolListItemContent = $spolListItem.Content\n        Write-Host "Auditing Item Id: ${spolListItemId} in ${spolListToAuditTitle}" -ForegroundColor Green\n        $response = aws comprehend detect-pii-entities --language-code en --text $spolListItemContent\n        $auditResponse = $response | ConvertFrom-Json -AsHashtable\n        if ($auditResponse.Entities) {\n            $auditEntitiesCount = $auditResponse.Entities.Count\n            if ($auditEntitiesCount -gt 0) {\n                Write-Host "Findings Count: ${auditEntitiesCount}" -ForegroundColor Magenta\n                $piiFindings = @()\n                ForEach ($piiEntity in $auditResponse.Entities) {\n                    $piiFinding = New-Object -TypeName PSObject\n                    $piiFinding | Add-Member -MemberType NoteProperty -Name "Score" -Value $piiEntity.Score\n                    $piiFinding | Add-Member -MemberType NoteProperty -Name "Type" -Value $piiEntity.Type\n                    $piiFinding | Add-Member -MemberType NoteProperty -Name "BeginOffset" -Value $piiEntity.BeginOffset\n                    $piiFinding | Add-Member -MemberType NoteProperty -Name "EndOffset" -Value $piiEntity.EndOffset\n                    $piiFindings += $piiFinding\n                }\n                $outputFilePath = "${outputDir}/$(get-date -f yyyyMMdd-HHmmss)-PIIFindings.csv"\n                $piiFindings | Export-Csv -Path $outputFilePath -NoTypeInformation\n                $auditEntry = m365 spo listitem add --contentType Item --listTitle $spolListToSaveAuditResponse --webUrl $spolSiteUrl --Title $spolListToAuditTitle --ItemID $spolListItemId --AuditCount $auditResponse.Entities.Count --AuditResult $outputFilePath -o json | ConvertFrom-Json -AsHashtable\n                $auditEntryId = $auditEntry.Id\n                Write-Host "Audit added for source Item Id: ${spolListItemId} with Item Id ${auditEntryId} in target list ${spolListToSaveAuditResponse}" -ForegroundColor Green\n            }\n            else {\n                Write-Host "There are no findings in this item" -ForegroundColor Yellow\n            }\n        }\n        else {\n            Write-Host "There are no findings in this item" -ForegroundColor Yellow\n        }\n    }\n}\nelse {\n    Write-Host "No items in this list" -ForegroundColor Yellow\n}\n')))),(0,r.kt)("p",null,"Output:"),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(10988).Z},(0,r.kt)("img",{alt:"pii-audit-report-list",src:n(44831).Z,width:"1157",height:"223"}))),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(33735).Z},(0,r.kt)("img",{alt:"pii-audit-report-data",src:n(33811).Z,width:"868",height:"420"}))))}f.isMDXComponent=!0},33735:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/files/pii-audit-report-data-76319626998a0689892702aa9b871a04.png"},69543:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/files/pii-audit-report-list-schema-dc56f3808dc925f8a6c009958030e278.png"},10988:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/files/pii-audit-report-list-c1f1b4f800c4d9079c578315be90c02a.png"},12847:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/files/pii-source-list-6b387f5c56e5dff9e15c47ce7dbf45f4.png"},33811:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/pii-audit-report-data-76319626998a0689892702aa9b871a04.png"},37365:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/pii-audit-report-list-schema-dc56f3808dc925f8a6c009958030e278.png"},44831:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/pii-audit-report-list-c1f1b4f800c4d9079c578315be90c02a.png"},54974:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/pii-source-list-6b387f5c56e5dff9e15c47ce7dbf45f4.png"}}]);